{
  "title": "Security API Documentation",
  "description": "API endpoints for NegraRosa security framework integration in the FibonroseTrust system",
  "version": "1.0.0",
  "baseUrl": "/api/v1/security",
  "endpoints": [
    {
      "path": "/why-verification",
      "method": "POST",
      "description": "Perform WHY (Who, How, Yes) verification for enhanced security",
      "parameters": {
        "body": {
          "type": "object",
          "properties": {
            "userId": {
              "type": "integer",
              "description": "User ID",
              "required": true
            },
            "verificationType": {
              "type": "string",
              "description": "Type of verification",
              "enum": ["identity", "transaction", "access"],
              "required": false,
              "default": "identity"
            },
            "metadata": {
              "type": "object",
              "description": "Additional context for verification",
              "required": false
            }
          }
        }
      },
      "responses": {
        "200": {
          "description": "WHY verification completed",
          "schema": {
            "type": "object",
            "properties": {
              "success": {"type": "boolean"},
              "message": {"type": "string"},
              "data": {
                "type": "object",
                "properties": {
                  "userId": {"type": "integer"},
                  "verificationType": {"type": "string"},
                  "securityLevel": {"type": "string", "enum": ["low", "standard", "enhanced", "maximum"]},
                  "timestamp": {"type": "string", "format": "date-time"}
                }
              }
            }
          }
        },
        "400": {
          "description": "User ID is required"
        },
        "500": {
          "description": "Failed to perform WHY verification"
        }
      },
      "requiresAuth": true
    },
    {
      "path": "/risk-assessment",
      "method": "POST",
      "description": "Perform risk assessment for a user transaction or action",
      "parameters": {
        "body": {
          "type": "object",
          "properties": {
            "userId": {
              "type": "integer",
              "description": "User ID",
              "required": true
            },
            "transactionType": {
              "type": "string",
              "description": "Type of transaction",
              "required": false,
              "default": "general"
            },
            "metadata": {
              "type": "object",
              "description": "Transaction metadata including trust score",
              "required": false
            }
          }
        }
      },
      "responses": {
        "200": {
          "description": "Risk assessment completed",
          "schema": {
            "type": "object",
            "properties": {
              "success": {"type": "boolean"},
              "message": {"type": "string"},
              "data": {
                "type": "object",
                "properties": {
                  "userId": {"type": "integer"},
                  "riskLevel": {"type": "string", "enum": ["low", "moderate", "high", "critical"]},
                  "transactionType": {"type": "string"},
                  "recommendations": {
                    "type": "array",
                    "items": {"type": "string"}
                  },
                  "limits": {
                    "type": "object",
                    "properties": {
                      "maxTransactionAmount": {"type": "number"},
                      "dailyLimit": {"type": "number"},
                      "monthlyLimit": {"type": "number"}
                    }
                  },
                  "timestamp": {"type": "string", "format": "date-time"}
                }
              }
            }
          }
        },
        "400": {
          "description": "User ID is required"
        },
        "500": {
          "description": "Failed to perform risk assessment"
        }
      },
      "requiresAuth": true
    },
    {
      "path": "/recommendations/user/{userId}",
      "method": "GET",
      "description": "Get security recommendations for a user based on their trust level and activity",
      "parameters": {
        "path": [
          {
            "name": "userId",
            "type": "integer",
            "description": "User ID",
            "required": true
          }
        ]
      },
      "responses": {
        "200": {
          "description": "Security recommendations",
          "schema": {
            "type": "object",
            "properties": {
              "success": {"type": "boolean"},
              "message": {"type": "string"},
              "data": {
                "type": "object",
                "properties": {
                  "userId": {"type": "integer"},
                  "currentSecurityLevel": {"type": "string"},
                  "recommendations": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "type": {"type": "string"},
                        "priority": {"type": "string", "enum": ["low", "medium", "high"]},
                        "description": {"type": "string"},
                        "action": {"type": "string"}
                      }
                    }
                  },
                  "nextLevelRequirements": {
                    "type": "array",
                    "items": {"type": "string"}
                  }
                }
              }
            }
          }
        },
        "404": {
          "description": "User not found"
        }
      },
      "requiresAuth": true
    },
    {
      "path": "/audit-log",
      "method": "GET",
      "description": "Get security audit log for monitoring and compliance",
      "parameters": {
        "query": [
          {
            "name": "userId",
            "type": "integer",
            "description": "Filter by user ID",
            "required": false
          },
          {
            "name": "action",
            "type": "string",
            "description": "Filter by action type",
            "required": false
          },
          {
            "name": "startDate",
            "type": "string",
            "description": "Start date for date range filter",
            "required": false
          },
          {
            "name": "endDate",
            "type": "string",
            "description": "End date for date range filter",
            "required": false
          },
          {
            "name": "page",
            "type": "integer",
            "description": "Page number for pagination",
            "required": false,
            "default": 1
          },
          {
            "name": "limit",
            "type": "integer",
            "description": "Number of items per page",
            "required": false,
            "default": 50
          }
        ]
      },
      "responses": {
        "200": {
          "description": "Audit log entries",
          "schema": {
            "type": "object",
            "properties": {
              "success": {"type": "boolean"},
              "message": {"type": "string"},
              "data": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "id": {"type": "integer"},
                    "userId": {"type": "integer"},
                    "action": {"type": "string"},
                    "resource": {"type": "string"},
                    "ipAddress": {"type": "string"},
                    "userAgent": {"type": "string"},
                    "timestamp": {"type": "string", "format": "date-time"},
                    "status": {"type": "string", "enum": ["success", "failure", "warning"]}
                  }
                }
              },
              "metadata": {
                "type": "object",
                "properties": {
                  "pagination": {
                    "type": "object",
                    "properties": {
                      "page": {"type": "integer"},
                      "limit": {"type": "integer"},
                      "totalItems": {"type": "integer"},
                      "totalPages": {"type": "integer"}
                    }
                  }
                }
              }
            }
          }
        }
      },
      "requiresAuth": true,
      "minTrustLevel": 8
    }
  ]
}
